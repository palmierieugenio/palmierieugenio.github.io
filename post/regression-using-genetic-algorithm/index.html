<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.26" />
  <meta name="author" content="Eugenio Palmieri">
  <meta name="description" content="Statistic Student">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/github.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.0/css/academicons.min.css" integrity="sha512-GGGNUPDhnG8LEAEDsjqYIQns+Gu8RBs4j5XGlxl7UfRaZBhCCm5jenJkeJL8uPuOXGqgl8/H1gjlWQDRjd3cUQ==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-105100692-1', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="/./index.xml" type="application/rss+xml" title="Computation Debate">
  <link rel="feed" href="/./index.xml" type="application/rss+xml" title="Computation Debate">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/./post/regression-using-genetic-algorithm/">

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#fffffb",
      "text": "#838391"
    },
    "button": {
      "background": "#4b81e8"
    }
  },
  "theme": "classic",
  "position": "top",
  "static": true
})});
</script>




<link href="https://fonts.googleapis.com/css?family=Orbitron:900" rel="stylesheet">





  <title>Regression using Genetic Algorithm | Computation Debate</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Computation Debate</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
<div class="article-header">
  <img src="/img/headers/evolutionary_algorithm_monkey.png" class="article-banner" itemprop="image">
  
</div>



  <div class="article-container">
    <h1 itemprop="name">Regression using Genetic Algorithm</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2019-09-14 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Sat, Sep 14, 2019
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/regression">regression</a
    >, 
    
    <a href="/categories/genetic-algorithm">Genetic Algorithm</a
    >, 
    
    <a href="/categories/r">r</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/regression">regression</a
    >, 
    
    <a href="/tags/genetic-algorithm">genetic algorithm</a
    >, 
    
    <a href="/tags/r">r</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
   <a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Regression%20using%20Genetic%20Algorithm&amp;url=%2f.%2fpost%2fregression-using-genetic-algorithm%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2f.%2fpost%2fregression-using-genetic-algorithm%2f&amp;title=Regression%20using%20Genetic%20Algorithm"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="googleplus"
         href="https://plus.google.com/share?url=%2f.%2fpost%2fregression-using-genetic-algorithm%2f&amp;title=Regression%20using%20Genetic%20Algorithm"
         target="_blank">
        <i class="fa fa-google-plus-official"></i>
      </a>
    </li> 
    <li>
      <a class="email"
         href="mailto:?subject=Regression%20using%20Genetic%20Algorithm&amp;body=%2f.%2fpost%2fregression-using-genetic-algorithm%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>

  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>The idea of this post is to solve (or at least approximate) the solution to Ordinary Least Squares (OLS), Least Absolute Deviation (LAD), Quantile Regression, Lasso and <span class="math inline">\(L0\)</span> regularization using Genetic Algorithm and the <a href="https://cran.r-project.org/web/packages/GA/vignettes/GA.html"><code>GA</code> package</a>.</p>
<div id="creating-the-data" class="section level1">
<h1>Creating the data</h1>
<p>I create data with some X not correlated with the response Y.</p>
<pre class="r"><code># Packages
library(GA)
library(L1pack)
library(L0Learn)
library(quantreg)
library(glmnet)
library(knitr)

# Problem data
set.seed(1)
p &lt;- 8
n &lt;- 5000
DENSITY &lt;- 0.5   # Fraction of non-zero beta
beta.mean&lt;-10; intercept&lt;-13
beta_true &lt;- matrix(rnorm(p, beta.mean), ncol = 1)
idxs &lt;- sample.int(p, size = floor((1 - DENSITY) * p), replace = FALSE)
beta_true[idxs] &lt;- 0
X &lt;- matrix(rnorm(n * p, sd = 5), nrow = n, ncol = p)
sigma &lt;- 20
eps &lt;- matrix(rnorm(n, sd = sigma), ncol = 1)
beta_true&lt;-c(intercept, beta_true)
X.intercept&lt;-cbind(1, X)
Y &lt;- X.intercept %*% beta_true + eps
K &lt;- as.numeric(ncol(X))
m &lt;- length(Y)

X&lt;-scale(X) # standardize for regularization techniques</code></pre>
</div>
<div id="ordinary-least-squares-ols" class="section level1">
<h1>Ordinary Least Squares (OLS)</h1>
<p>The solution could be easily calculated in closed form using <span class="math inline">\(\hat{\beta}_{OLS}= (X^T X)^{-1} X^T y\)</span>, which gives:</p>
<pre class="r"><code>beta.ols&lt;-function(xx=X, yy=Y){
        xx&lt;-cbind(1, xx)
        beta&lt;-solve(t(xx)%*%xx)%*%t(xx)%*%yy
        beta&lt;-as.numeric(beta)
}

ols.beta&lt;-beta.ols()</code></pre>
<p>In this case using Genetic Algorithm is definitely inefficient and less precise. The same is true for the other models in this post: they donâ€™t have generally a solution in closed form, but they have more robust numerical methods that take advantage of the structure of the problems.</p>
<p>To solve the problems with the package <code>GA</code> we need to specify some parameters:</p>
<pre class="r"><code>max.iter&lt;-10000 # max number of iteration
max.run&lt;-1000 # number of iteration without any improvement before stopping
theta&lt;-rep(0,p) # empty vector of suggested parameters without intercept
iper=0.01 # iperparameter for regularization methods
up&lt;-rep(100, p+1) # maximum values of parameters
low&lt;- -up # minimum values of parameters</code></pre>
<p>We can solve OLS, minimizing directly the function:</p>
<p><span class="math display">\[\min_{\beta} \sum_{i=1}^n (y_i - x_i^T \beta)^2 \]</span>
And maximize it, given lower and upper bounds for the parameters, in this case a vector <span class="math inline">\((-100, \dots, -100)\)</span> and a vector <span class="math inline">\((100, \dots, 100)\)</span>, and an optional vector of the suggested initial solution, in this case a vector <span class="math inline">\((0, \dots, 0)\)</span>.</p>
<pre class="r"><code># negative sign, since ga actually maximize the function
ols.func&lt;-function(beta, xx=X, yy=Y){  
        xx&lt;-cbind(1, xx)
        J &lt;- -sum((xx%*%beta- yy)^2)
        return(J) 
}
GA.ols &lt;- ga(type = &quot;real-valued&quot;, fitness = ols.func,
         lower = low, upper = up, suggestions = c(0,theta),
        popSize = 300, maxiter = max.iter, run = max.run, monitor = NULL)

GA.ols&lt;-as.numeric(summary(GA.ols)$solution)</code></pre>
</div>
<div id="least-absolute-deviation-lad" class="section level1">
<h1>Least Absolute Deviation (LAD)</h1>
<p>The Least Absolute Deviation (LAD) doesnâ€™t have a solution in closed form, but can be solved with numerical methods, like Barrodale and Roberts algorithm (the default of the <code>L1pack</code> package used in this post) or EM:</p>
<pre class="r"><code># pacchetto L1pack
lad.package&lt;-lad(Y~X, data=list(X,Y), method = &quot;BR&quot;)$coefficients</code></pre>
<p>We can solve LAD, minimizing directly the function:</p>
<p><span class="math display">\[\min_{\beta} \sum_{i=1}^n |y_i - x_i^T \beta| \]</span></p>
<pre class="r"><code># negative sign, since ga actually maximize the function
lad.func&lt;-function(beta, xx=X, yy=Y){  
  xx&lt;-cbind(1, xx)
  lad&lt;-sum(abs(yy-xx%*%beta))
  J&lt;- - lad
  return(J) 
}

GA.lad &lt;- ga(type = &quot;real-valued&quot;, fitness = lad.func,
               lower = low, upper =up,
              suggestions=c(0,theta),
               popSize = 300, maxiter = max.iter,
             run = max.run, monitor = NULL)

GA.lad&lt;-as.numeric(summary(GA.lad)$solution)</code></pre>
</div>
<div id="quantile-regression" class="section level1">
<h1>Quantile Regression</h1>
<p>Also quantile regression can be solved with several numerical methods: the default one used by <code>quantreg</code> is a modified version of the Barrodale and Roberts algorithm for l1-regression described in detail in Koenker and dâ€™Orey (1987, 1994). For larger problems it is advantageous to use the Frisch-Newton interior point method or other variants described in detail in Portnoy and Koenker(1997).</p>
<pre class="r"><code>quantile.fit&lt;-rq(Y~X, data=list(X,Y), tau = c(0.05, 0.5, 0.95), method = &quot;br&quot;)
quantile.fit&lt;-t(quantile.fit$coefficients)</code></pre>
<p>The loss of quantile regression can be calculated using the <em>check function</em>:</p>
<p><span class="math display">\[\rho(x, \ \tau)=
\begin{cases}
\tau x  &amp; \quad \text{if } x \geq 0\\
(1-\tau) x  &amp; \quad \text{if } x &lt; 0\\
\end{cases}\]</span></p>
<pre class="r"><code>check.function&lt;-function(z, t=0.5){
  risultato&lt;-ifelse(z&gt;=0, t*z, (t-1)*z)
  risultato[z==0]&lt;-0
  risultato
}</code></pre>
<p>Then we can define the loss function of the quantile regression as:</p>
<p><span class="math display">\[\min_{\beta} \frac{1}{n} \sum_{i=1}^n \rho(y_i - x_i^T \beta, \ \tau)\]</span></p>
<p>Where the constant <span class="math inline">\(\frac{1}{n}\)</span> can be omitted from the optimization procedure, since it doesnâ€™t depend on <span class="math inline">\(\beta\)</span>:</p>
<pre class="r"><code>quant_loss &lt;- function(beta, xx=X, yy=Y, tau=0.5) { 
  xx&lt;-cbind(1, xx)
  error&lt;-yy-xx%*%beta
  loss&lt;-check.function(error, t=tau)
  -sum(loss)
}

GA.quant &lt;- ga(type = &quot;real-valued&quot;, fitness = quant_loss, tau=0.5,
             lower = low, upper = up,
             suggestions = c(0,theta), # quantile.fit[1,],
             popSize = 300, maxiter = max.iter, run = max.run, monitor = NULL)

GA.quant.50&lt;-as.numeric(summary(GA.quant)$solution)

GA.quant.95 &lt;- ga(type = &quot;real-valued&quot;, fitness = quant_loss, tau=0.95,
               lower = low, upper =up,
               suggestions = c(0,theta), #quantile.fit[2,],
               popSize = 300, maxiter = max.iter, run = max.run, monitor = NULL)

GA.quant.95&lt;-as.numeric(summary(GA.quant.95)$solution)

GA.quant.05 &lt;- ga(type = &quot;real-valued&quot;, fitness = quant_loss, tau=0.05,
                  lower = low, upper = up,
                  suggestions = c(0,theta),#  quantile.fit[3,],
                  popSize = 300, maxiter = max.iter, run = max.run, monitor = NULL)

GA.quant.05&lt;-as.numeric(summary(GA.quant.05)$solution)</code></pre>
</div>
<div id="lasso---l1-penalization" class="section level1">
<h1>Lasso - <span class="math inline">\(L1\)</span> Penalization</h1>
<p>The Least Absoulute Shrinkage and Selection Operator (Lasso) problem can be solved with the <code>glmnet</code> package that uses cyclical coordinate descent algorithms, which successively optimizes the objective function over each parameter with others fixed, and cycles repeatedly until convergence:</p>
<pre class="r"><code>fit.glmnet.lasso&lt;-glmnet(X, Y, family =&quot;gaussian&quot;, lambda = iper)
lasso.glmnet&lt;-as.numeric(coef(fit.glmnet.lasso))</code></pre>
<p>The loss can be minimized directly:</p>
<p><span class="math display">\[\min_\beta \frac{1}{2n} \sum_{i=1}^n (y_i - \beta_0 - \sum_{j=1}^p x_{ij} \beta_j )^2 + \lambda \sum_{j=1}^p |\beta_j|\]</span></p>
<pre class="r"><code>lasso.loss&lt;-function(beta, xx=X, yy=Y, lambda=iper){  
        const&lt;-1/(length(yy)*2)
        # xx&lt;-scale(xx) # already normalized previously!
        ols&lt;-sum((yy-xx%*%beta)^2)
        J &lt;- -((const*ols)+(lambda*sum(abs(beta)) ))
        return(J) 
}</code></pre>
<p>The X must be standardized before optimizing the function. The intercept is not used in the optimization procedure and itâ€™s estimated using:</p>
<p><span class="math display">\[\hat{\beta}_0= \bar{y} -  \sum_{j=1}^p \bar{x}_j \hat{\beta}_j\]</span></p>
<pre class="r"><code>intercept.mean&lt;-function(beta, xx=X, yy=Y){
  intercept&lt;-mean(yy)-apply(xx,2,mean)%*%beta
  intercept
}</code></pre>
<p>So the full solution is given by:</p>
<pre class="r"><code>GA.lasso &lt;- ga(type = &quot;real-valued&quot;, fitness = lasso.loss,
               lower = low[-1], upper = up[-1],
               suggestions=theta, # rbind(theta, lasso.glmnet[-1]),
               popSize = 300, maxiter = max.iter,
               run = max.run, monitor = NULL)


GA.lasso&lt;-as.numeric(summary(GA.lasso)$solution)
GA.lasso&lt;-c(intercept.mean(GA.lasso), GA.lasso)</code></pre>
</div>
<div id="zero-norm-l0-regularization" class="section level1">
<h1>Zero Norm L0 Regularization</h1>
<p>The L0 regularization is very similar, but it penalizes the <span class="math inline">\(\beta \neq 0\)</span>:</p>
<p><span class="math display">\[\min_\beta \frac{1}{2n} \sum_{i=1}^n (y_i - \beta_0 - \sum_{j=1}^p x_{ij} \beta_j )^2 + \lambda \sum_{j=1}^p I_{\beta_j \neq 0}(\beta_j)\]</span></p>
<p>Where <span class="math inline">\(I_{beta_j \neq 0}(x)\)</span> returns 1 if <span class="math inline">\(\beta_j \neq 0\)</span> and 0 otherwise.</p>
<p>The problem can be solved with the package <code>L0Learn</code> which uses a variant of cyclic coordinate descent as default or a local combinatorial search on top of coordinate descent (typically achieves higher quality solutions at the expense of increased running time).</p>
<pre class="r"><code># L0 regularization L0Learn package
fit.L0&lt;-L0Learn.fit(X, Y, penalty=&quot;L0&quot;, autoLambda=FALSE, lambdaGrid=list(iper),
                    loss=&quot;SquaredError&quot;, algorithm = &quot;CD&quot;)
L0.package&lt;-as.numeric(coef(fit.L0))</code></pre>
<p>The loss can be minimized directly using <code>GA</code>:</p>
<pre class="r"><code>L0.loss&lt;-function(beta, xx=X, yy=Y, lambda=iper){  
  const&lt;-1/length(yy)
  ols&lt;-sum((yy-xx%*%beta)^2)
  J &lt;- -((const*ols)+(lambda*sum(beta!=0) ))
  return(J) 
}

GA.zero.norm &lt;- ga(type = &quot;real-valued&quot;, fitness = L0.loss,
             lower = low[-1], upper = up[-1],
             suggestions=theta,# rbind(theta, lasso.glmnet[-1], L0.package[-1]),
             popSize = 300, maxiter = max.iter, run = max.run, monitor = NULL)

GA.zero.norm&lt;-as.numeric(summary(GA.zero.norm)$solution)
GA.zero.norm&lt;-c(intercept.mean(GA.zero.norm), GA.zero.norm)</code></pre>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<p>We can compare the results of <code>GA</code> with the true beta (since we know the data generation process) and with their packages counterpart:</p>
<pre class="r"><code>beta.problema&lt;-rbind(beta_true=beta_true,
                     ols.beta=ols.beta,
                     GA.ols=GA.ols,
                     lad.package=lad.package,
                     GA.lad=GA.lad,
                     quantile.fit,
                     GA.quant.05=GA.quant.05,
                     GA.quant.50=GA.quant.50,
                     GA.quant.95=GA.quant.95,
                     lasso.glmnet=lasso.glmnet,
                     GA.lasso=GA.lasso,
                     L0.package=L0.package,
                     GA.zero.norm=GA.zero.norm)

kable(round(beta.problema,2))</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">(Intercept)</th>
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>beta_true</td>
<td align="right">13.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">9.16</td>
<td align="right">11.60</td>
<td align="right">10.33</td>
<td align="right">0.00</td>
<td align="right">10.49</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td>ols.beta</td>
<td align="right">11.30</td>
<td align="right">0.43</td>
<td align="right">-0.10</td>
<td align="right">46.21</td>
<td align="right">57.34</td>
<td align="right">53.04</td>
<td align="right">-0.24</td>
<td align="right">52.34</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td>GA.ols</td>
<td align="right">11.32</td>
<td align="right">0.40</td>
<td align="right">-0.07</td>
<td align="right">46.14</td>
<td align="right">57.31</td>
<td align="right">53.03</td>
<td align="right">-0.23</td>
<td align="right">52.26</td>
<td align="right">0.09</td>
</tr>
<tr class="even">
<td>lad.package</td>
<td align="right">10.99</td>
<td align="right">0.41</td>
<td align="right">-0.48</td>
<td align="right">46.42</td>
<td align="right">57.20</td>
<td align="right">52.83</td>
<td align="right">-0.37</td>
<td align="right">52.65</td>
<td align="right">0.12</td>
</tr>
<tr class="odd">
<td>GA.lad</td>
<td align="right">10.98</td>
<td align="right">0.39</td>
<td align="right">-0.47</td>
<td align="right">46.43</td>
<td align="right">57.18</td>
<td align="right">52.81</td>
<td align="right">-0.36</td>
<td align="right">52.66</td>
<td align="right">0.14</td>
</tr>
<tr class="even">
<td>tau= 0.05</td>
<td align="right">-22.26</td>
<td align="right">1.40</td>
<td align="right">0.59</td>
<td align="right">45.40</td>
<td align="right">57.32</td>
<td align="right">53.27</td>
<td align="right">-0.53</td>
<td align="right">52.32</td>
<td align="right">-0.65</td>
</tr>
<tr class="odd">
<td>tau= 0.50</td>
<td align="right">10.99</td>
<td align="right">0.41</td>
<td align="right">-0.48</td>
<td align="right">46.42</td>
<td align="right">57.20</td>
<td align="right">52.83</td>
<td align="right">-0.37</td>
<td align="right">52.65</td>
<td align="right">0.12</td>
</tr>
<tr class="even">
<td>tau= 0.95</td>
<td align="right">44.48</td>
<td align="right">-0.10</td>
<td align="right">0.15</td>
<td align="right">45.98</td>
<td align="right">56.80</td>
<td align="right">52.67</td>
<td align="right">0.04</td>
<td align="right">51.87</td>
<td align="right">0.93</td>
</tr>
<tr class="odd">
<td>GA.quant.05</td>
<td align="right">-22.22</td>
<td align="right">1.46</td>
<td align="right">0.51</td>
<td align="right">45.35</td>
<td align="right">57.27</td>
<td align="right">53.31</td>
<td align="right">-0.48</td>
<td align="right">52.21</td>
<td align="right">-0.70</td>
</tr>
<tr class="even">
<td>GA.quant.50</td>
<td align="right">10.99</td>
<td align="right">0.42</td>
<td align="right">-0.47</td>
<td align="right">46.44</td>
<td align="right">57.18</td>
<td align="right">52.79</td>
<td align="right">-0.37</td>
<td align="right">52.66</td>
<td align="right">0.14</td>
</tr>
<tr class="odd">
<td>GA.quant.95</td>
<td align="right">44.53</td>
<td align="right">-0.14</td>
<td align="right">0.18</td>
<td align="right">45.79</td>
<td align="right">56.70</td>
<td align="right">52.53</td>
<td align="right">0.05</td>
<td align="right">51.84</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td>lasso.glmnet</td>
<td align="right">11.30</td>
<td align="right">0.42</td>
<td align="right">-0.09</td>
<td align="right">46.20</td>
<td align="right">57.33</td>
<td align="right">53.03</td>
<td align="right">-0.23</td>
<td align="right">52.33</td>
<td align="right">0.08</td>
</tr>
<tr class="odd">
<td>GA.lasso</td>
<td align="right">11.30</td>
<td align="right">0.42</td>
<td align="right">-0.09</td>
<td align="right">46.20</td>
<td align="right">57.27</td>
<td align="right">53.02</td>
<td align="right">-0.22</td>
<td align="right">52.28</td>
<td align="right">0.06</td>
</tr>
<tr class="even">
<td>L0.package</td>
<td align="right">11.30</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">46.20</td>
<td align="right">57.34</td>
<td align="right">53.04</td>
<td align="right">0.00</td>
<td align="right">52.34</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td>GA.zero.norm</td>
<td align="right">11.30</td>
<td align="right">0.42</td>
<td align="right">-0.12</td>
<td align="right">46.17</td>
<td align="right">57.31</td>
<td align="right">52.94</td>
<td align="right">-0.22</td>
<td align="right">52.24</td>
<td align="right">0.09</td>
</tr>
</tbody>
</table>
<p>All the results of <code>GA</code> are close to their package counterpart, excluded the zero norm and the package <code>L0Learn</code>, which tends to have a more sparse solution. This could be due to a numerical approximation or just a different parametrization since the package authors didnâ€™t write the full mathematical formula used in the package. If that is the case, we are optimizing different functions, where the iperparamer <span class="math inline">\(\lambda\)</span> may have a different meaning.</p>
<p>Itâ€™s possible to calculate the predictions and errors from the <span class="math inline">\(\beta\)</span>:</p>
<pre class="r"><code>predictions&lt;-X.intercept%*%t(beta.problema)
errors&lt;-apply(predictions, 2, function(x) Y-x)
mae&lt;-apply(errors, 2, function(x) mean(abs(x)))
kable(mae, col.names = &quot;MAE&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>beta_true</td>
<td align="right">16.11658</td>
</tr>
<tr class="even">
<td>ols.beta</td>
<td align="right">331.65362</td>
</tr>
<tr class="odd">
<td>GA.ols</td>
<td align="right">331.30705</td>
</tr>
<tr class="even">
<td>lad.package</td>
<td align="right">331.88195</td>
</tr>
<tr class="odd">
<td>GA.lad</td>
<td align="right">331.84284</td>
</tr>
<tr class="even">
<td>tau= 0.05</td>
<td align="right">332.02116</td>
</tr>
<tr class="odd">
<td>tau= 0.50</td>
<td align="right">331.88195</td>
</tr>
<tr class="even">
<td>tau= 0.95</td>
<td align="right">329.40789</td>
</tr>
<tr class="odd">
<td>GA.quant.05</td>
<td align="right">331.70249</td>
</tr>
<tr class="even">
<td>GA.quant.50</td>
<td align="right">331.81229</td>
</tr>
<tr class="odd">
<td>GA.quant.95</td>
<td align="right">328.50262</td>
</tr>
<tr class="even">
<td>lasso.glmnet</td>
<td align="right">331.57432</td>
</tr>
<tr class="odd">
<td>GA.lasso</td>
<td align="right">331.33601</td>
</tr>
<tr class="even">
<td>L0.package</td>
<td align="right">331.66200</td>
</tr>
<tr class="odd">
<td>GA.zero.norm</td>
<td align="right">331.12767</td>
</tr>
</tbody>
</table>
<p>The regularized methods donâ€™t outperform the others, since I havenâ€™t chosen the iperparameter <span class="math inline">\(\lambda\)</span> by validation: I have just chosen one to replicate the results of the packages.</p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>Genetic Algorithms can be very useful when we donâ€™t have a solution in closed form or when we canâ€™t employ other more consistent numerical methods (especially for non-convex problems). This article is mostly an exercise to the use of Genetic Algorithm in regression, but the real advantage of <code>GA</code> can appear with less trivial losses to minimize.</p>
<p>At the same time, we have shown that <code>GA</code> can give a good approximation of other numerical methods, but it is very slow and it is generally better to employ more <em>smart</em> solutions.</p>
<p>Genetic Algorithms can be a useful first step to try to solve problems we donâ€™t fully understand, a smart use of brute force.</p>
</div>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="/./post/2017-09-13-download-books-for-free/"><span
      aria-hidden="true">&larr;</span> Download books for free</a></li>
    

    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread">
    <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "palmierieugenio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Eugenio Palmieri &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/r.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/yaml.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/c.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/bash.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/python.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/processing.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/stata.min.js"></script>
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/languages/tex.min.js"></script>
      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    
    

  </body>
</html>

